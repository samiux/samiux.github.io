<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>血脂指数计算器</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #1a2a6c);
            color: #333;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(to right, #2c3e50, #4a6491);
            color: white;
            padding: 20px;
            text-align: center;
            position: relative;
        }
        
        h1 {
            font-size: 1.8rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .date-time {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 10px;
            flex-wrap: wrap;
        }
        
        .date-time input {
            padding: 8px 12px;
            border-radius: 8px;
            border: 1px solid #ddd;
            font-size: 0.9rem;
            background: white;
        }
        
        .tabs {
            display: flex;
            background: #4a6491;
            overflow-x: auto;
        }
        
        .tab {
            padding: 15px 20px;
            background: #4a6491;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            white-space: nowrap;
            font-size: 0.9rem;
            border-right: 1px solid rgba(255,255,255,0.1);
        }
        
        .tab.active {
            background: #2c3e50;
            font-weight: bold;
        }
        
        .tab-content {
            display: none;
            padding: 25px;
            animation: fadeIn 0.5s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .tab-content.active {
            display: block;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        .input-row {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .input-box {
            flex: 1;
            min-width: 200px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }
        
        input {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s;
        }
        
        input:focus {
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
            outline: none;
        }
        
        .optional-label {
            color: #7f8c8d;
            font-size: 0.9rem;
            margin-left: 5px;
        }
        
        .btn-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        button {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-calculate {
            background: linear-gradient(to right, #27ae60, #2ecc71);
            color: white;
            flex: 1;
        }
        
        .btn-reset {
            background: linear-gradient(to right, #e74c3c, #c0392b);
            color: white;
        }
        
        .btn-export, .btn-import, .btn-save {
            background: linear-gradient(to right, #3498db, #2980b9);
            color: white;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .results-container {
            margin-top: 30px;
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .result-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.08);
            border-left: 4px solid #3498db;
            transition: all 0.3s;
        }
        
        .result-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        }
        
        .result-card.high {
            border-left-color: #e74c3c;
            background: #fff5f5;
        }
        
        .result-card.low {
            border-left-color: #27ae60;
            background: #f5fff7;
        }
        
        .result-card.disabled {
            border-left-color: #95a5a6;
            background: #f5f7fa;
        }
        
        .result-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .result-value {
            font-size: 1.8rem;
            font-weight: 700;
            margin: 10px 0;
            color: #3498db;
        }
        
        .result-status {
            font-weight: 600;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.9rem;
            display: inline-block;
        }
        
        .status-normal {
            background: #d5f5e3;
            color: #27ae60;
        }
        
        .status-warning {
            background: #fdebd0;
            color: #e67e22;
        }
        
        .status-danger {
            background: #fadbd8;
            color: #e74c3c;
        }
        
        .status-info {
            background: #d6eaf8;
            color: #3498db;
        }
        
        .research-section {
            margin-top: 30px;
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
        }
        
        .research-section h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .reference-item {
            margin: 15px 0;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
        }
        
        .reference-title {
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .reference-authors, .reference-journal {
            font-size: 0.9rem;
            color: #555;
            margin-bottom: 3px;
        }
        
        .reference-doi {
            font-size: 0.85rem;
            color: #3498db;
            margin-top: 5px;
        }
        
        .data-management {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        @media (max-width: 768px) {
            .data-management {
                grid-template-columns: 1fr;
            }
        }
        
        .data-card {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.08);
        }
        
        .data-card h3 {
            margin-bottom: 15px;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .data-list {
            max-height: 300px;
            overflow-y: auto;
            margin-top: 15px;
        }
        
        .data-item {
            padding: 12px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .data-item:last-child {
            border-bottom: none;
        }
        
        .data-item .actions {
            display: flex;
            gap: 10px;
        }
        
        .btn-small {
            padding: 5px 10px;
            font-size: 0.8rem;
            border-radius: 5px;
        }
        
        .btn-edit {
            background: #3498db;
            color: white;
        }
        
        .btn-delete {
            background: #e74c3c;
            color: white;
        }
        
        .lp-a-info {
            background: #e8f4fc;
            border-radius: 12px;
            padding: 20px;
            margin-top: 30px;
            border-left: 4px solid #3498db;
        }
        
        .lp-a-info h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .lp-a-values {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .lp-a-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
        }
        
        .lp-a-range {
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .lp-a-interpretation {
            font-size: 0.9rem;
            color: #555;
        }
        
        .unit-info {
            background: #e8f4fc;
            border-radius: 12px;
            padding: 15px;
            margin-top: 15px;
            font-size: 0.9rem;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            background: #27ae60;
            color: white;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transform: translateX(120%);
            transition: transform 0.3s ease-in-out;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification.error {
            background: #e74c3c;
        }
        
        footer {
            text-align: center;
            padding: 20px;
            color: white;
            background: #2c3e50;
            margin-top: 20px;
            border-radius: 0 0 20px 20px;
        }
        
        @media (max-width: 600px) {
            .tabs {
                flex-direction: column;
            }
            
            .tab {
                border-right: none;
                border-bottom: 1px solid rgba(255,255,255,0.1);
            }
            
            .results-grid {
                grid-template-columns: 1fr;
            }
            
            .input-row {
                flex-direction: column;
            }
        }
        
        .empty-state {
            text-align: center;
            padding: 30px;
            color: #777;
        }
        
        .empty-state i {
            font-size: 3rem;
            margin-bottom: 15px;
            color: #3498db;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-heartbeat"></i> 血脂指数计算器 </h1>
            <p class="subtitle">基于最新医学研究的血脂分析与健康评估工具</p>
            <div class="date-time">
                <div>
                    <label for="currentDate">当前日期：</label>
                    <input type="date" id="currentDate">
                </div>
                <div>
                    <label for="currentTime">当前时间：</label>
                    <input type="time" id="currentTime">
                </div>
            </div>
        </header>
        
        <div class="tabs">
            <div class="tab active" data-tab="calculator">计算器</div>
            <div class="tab" data-tab="data">数据管理</div>
            <div class="tab" data-tab="research">研究参考</div>
            <div class="tab" data-tab="lp-a">Lp(a)参考值</div>
        </div>
        
        <div class="tab-content active" id="calculator-content">
            <div class="input-group">
                <h2><i class="fas fa-calculator"></i> 血脂参数输入</h2>
                <p>请输入您的血脂检测值（国际单位：mmol/L），带<span class="optional-label">*</span>为可选参数</p>
                
                <div class="input-row">
                    <div class="input-box">
                        <label for="tc">总胆固醇 (TC, mmol/L)</label>
                        <input type="number" id="tc" step="0.01" placeholder="例如: 5.20" required>
                    </div>
                    <div class="input-box">
                        <label for="hdl">高密度脂蛋白 (HDL-C, mmol/L)</label>
                        <input type="number" id="hdl" step="0.01" placeholder="例如: 1.55" required>
                    </div>
                </div>
                
                <div class="input-row">
                    <div class="input-box">
                        <label for="tg">甘油三酯 (TG, mmol/L)</label>
                        <input type="number" id="tg" step="0.01" placeholder="例如: 1.70" required>
                    </div>
                    <div class="input-box">
                        <label for="ldl">低密度脂蛋白 (LDL-C, mmol/L)</label>
                        <input type="number" id="ldl" step="0.01" placeholder="例如: 3.10" required>
                    </div>
                </div>
                
                <div class="input-row">
                    <div class="input-box">
                        <label for="apoA1">载脂蛋白A1 (ApoA1, g/L) <span class="optional-label">*</span></label>
                        <input type="number" id="apoA1" step="0.01" placeholder="例如: 1.45 (可选)">
                    </div>
                    <div class="input-box">
                        <label for="apoB">载脂蛋白B (ApoB, g/L) <span class="optional-label">*</span></label>
                        <input type="number" id="apoB" step="0.01" placeholder="例如: 0.95 (可选)">
                    </div>
                </div>
                
                <div class="btn-group">
                    <button class="btn-calculate" id="calculateBtn">
                        <i class="fas fa-calculator"></i> 计算所有指数
                    </button>
                    <button class="btn-reset" id="resetBtn">
                        <i class="fas fa-redo"></i> 重置
                    </button>
                </div>
            </div>
            
            <div class="results-container">
                <h2><i class="fas fa-chart-line"></i> 计算结果</h2>
                <div class="results-grid" id="resultsGrid">
                    <div class="empty-state">
                        <i class="fas fa-calculator"></i>
                        <h3>等待计算结果</h3>
                        <p>输入您的血脂参数后点击"计算"按钮</p>
                    </div>
                </div>
            </div>
            
            <div class="btn-group">
                <button class="btn-save" id="saveResultBtn">
                    <i class="fas fa-save"></i> 保存当前计算结果
                </button>
            </div>
            
            <div class="lp-a-info">
                <h3><i class="fas fa-info-circle"></i> Lp(a) 参考值 (μmol/L)</h3>
                <p>脂蛋白(a) [Lp(a)] 是心血管疾病的重要独立风险因素，不受饮食影响</p>
                <div class="lp-a-values">
                    <div class="lp-a-card">
                        <div class="lp-a-range">理想水平: &lt; 75 μmol/L</div>
                        <div class="lp-a-interpretation">心血管风险最低</div>
                    </div>
                    <div class="lp-a-card">
                        <div class="lp-a-range">临界高值: 75-125 μmol/L</div>
                        <div class="lp-a-interpretation">中度心血管风险</div>
                    </div>
                    <div class="lp-a-card">
                        <div class="lp-a-range">高风险: 125-250 μmol/L</div>
                        <div class="lp-a-interpretation">显著心血管风险</div>
                    </div>
                    <div class="lp-a-card">
                        <div class="lp-a-range">极高风险: &gt; 250 μmol/L</div>
                        <div class="lp-a-interpretation">心血管风险极高</div>
                    </div>
                </div>
                <div class="unit-info">
                    <p><strong>单位换算：</strong> 1 mg/dL ≈ 0.025 μmol/L (Lp(a))</p>
                </div>
            </div>
        </div>
        
        <div class="tab-content" id="data-content">
            <h2><i class="fas fa-database"></i> 数据管理</h2>
            <p>管理您的血脂计算结果，支持导入导出JSON格式数据</p>
            
            <div class="data-management">
                <div class="data-card">
                    <h3><i class="fas fa-save"></i> 保存当前数据</h3>
                    <label for="recordNameData">记录名称：</label>
                    <input type="text" id="recordNameData" placeholder="例如: 2023年体检">
                    <div class="btn-group" style="margin-top: 15px;">
                        <button class="btn-save" id="saveDataBtn">
                            <i class="fas fa-save"></i> 保存当前记录
                        </button>
                    </div>
                </div>
                
                <div class="data-card">
                    <h3><i class="fas fa-history"></i> 历史记录</h3>
                    <div class="data-list" id="historyList">
                        <div class="empty-state">
                            <i class="fas fa-database"></i>
                            <h3>暂无历史记录</h3>
                            <p>保存计算结果后将会显示在这里</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="btn-group" style="margin-top: 20px;">
                <button class="btn-export" id="exportBtn">
                    <i class="fas fa-file-export"></i> 导出所有数据
                </button>
                <button class="btn-import" id="importBtn">
                    <i class="fas fa-file-import"></i> 导入数据
                </button>
                <input type="file" id="importFile" style="display: none;">
            </div>
        </div>
        
        <div class="tab-content" id="research-content">
            <h2><i class="fas fa-book"></i> 血脂指数研究参考</h2>
            
            <div class="research-section">
                <h3><i class="fas fa-clipboard-list"></i> 指数意义与参考范围</h3>
                
                <div class="results-grid">
                    <div class="result-card">
                        <div class="result-title"><i class="fas fa-divide"></i> TC/HDL-C 比值</div>
                        <div class="result-description">
                            <p><strong>参考范围：</strong> &lt; 4.0（理想）</p>
                            <p>评估心血管疾病风险的重要指标，比值越高风险越大。研究表明，TC/HDL-C比值是比单独TC或LDL-C更好的心血管风险预测指标。</p>
                        </div>
                    </div>
                    
                    <div class="result-card">
                        <div class="result-title"><i class="fas fa-divide"></i> TG/HDL-C 比值</div>
                        <div class="result-description">
                            <p><strong>参考范围：</strong> &lt; 1.0（理想）</p>
                            <p>胰岛素抵抗的标志，比值升高预示代谢综合征风险。研究显示，TG/HDL-C比值>1.33与胰岛素抵抗密切相关。</p>
                        </div>
                    </div>
                    
                    <div class="result-card">
                        <div class="result-title"><i class="fas fa-divide"></i> LDL-C/HDL-C 比值</div>
                        <div class="result-description">
                            <p><strong>参考范围：</strong> &lt; 2.5（理想）</p>
                            <p>评估胆固醇平衡的重要指标，反映心血管风险。该比值>3.5时心血管风险显著增加。</p>
                        </div>
                    </div>
                    
                    <div class="result-card">
                        <div class="result-title"><i class="fas fa-calculator"></i> 动脉硬化指数 (AI)</div>
                        <div class="result-description">
                            <p><strong>参考范围：</strong> &lt; 3.0（理想）</p>
                            <p>计算：(TC - HDL-C)/HDL-C，评估动脉硬化风险。研究显示AI与冠状动脉钙化评分显著相关。</p>
                        </div>
                    </div>

                    <div class="result-card">
                        <div class="result-title"><i class="fas fa-calculator"></i> 残余胆固醇 (RC)</div>
                        <div class="result-description">
                            <p><strong>参考范围：</strong> &lt; 1.0（理想）</p>
                            <p>这些成分不仅能沉积在血管壁上，还具有很强的促炎性和致动脉粥样硬化能力。LDL-C升高 → 斑块不稳定风险增加2.38倍。LDL-C ↑ + 残余胆固醇 ↑ → 风险增加3.97倍。LDL-C ↑ + 甘油三酯 ↑ → 风险增加4.19倍</p>
                        </div>
                    </div>
                    
                    <div class="result-card">
                        <div class="result-title"><i class="fas fa-divide"></i> ApoA1/ApoB 比值</div>
                        <div class="result-description">
                            <p><strong>参考范围：</strong> &gt; 1.0（男性），&gt; 1.2（女性）</p>
                            <p>评估心血管风险的精准指标，比值越高保护性越强。研究显示ApoB/ApoA1比值是心肌梗死的最佳预测指标。</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="research-section">
                <h3><i class="fas fa-book-open"></i> 重要研究文献</h3>
                
                <div class="reference-item">
                    <div class="reference-title">脂质比值在心血管风险评估中的价值</div>
                    <div class="reference-authors">Millán J, et al.</div>
                    <div class="reference-journal">Clinical Cardiology, 2009</div>
                    <div class="reference-doi">DOI: 10.1002/clc.20600</div>
                </div>
                
                <div class="reference-item">
                    <div class="reference-title">ApoB/ApoA1比值与心肌梗死风险</div>
                    <div class="reference-authors">Walldius G, et al.</div>
                    <div class="reference-journal">The Lancet, 2001</div>
                    <div class="reference-doi">DOI: 10.1016/S0140-6736(01)06507-1</div>
                </div>
                
                <div class="reference-item">
                    <div class="reference-title">断食对血脂谱的影响：系统评价</div>
                    <div class="reference-authors">Varady KA, et al.</div>
                    <div class="reference-journal">Nutrition Reviews, 2021</div>
                    <div class="reference-doi">DOI: 10.1093/nutrit/nuaa091</div>
                </div>
                
                <div class="reference-item">
                    <div class="reference-title">TG/HDL比值作为胰岛素抵抗标志物的作用</div>
                    <div class="reference-authors">McLaughlin T, et al.</div>
                    <div class="reference-journal">Circulation, 2003</div>
                    <div class="reference-doi">DOI: 10.1161/01.CIR.0000074229.75728.D0</div>
                </div>
                
                <div class="reference-item">
                    <div class="reference-title">脂蛋白(a)与心血管疾病风险</div>
                    <div class="reference-authors">Tsimikas S, et al.</div>
                    <div class="reference-journal">Journal of the American College of Cardiology, 2018</div>
                    <div class="reference-doi">DOI: 10.1016/j.jacc.2018.06.056</div>
                </div>
                
                <div class="reference-item">
                    <div class="reference-title">血脂比值在预测心血管事件中的比较</div>
                    <div class="reference-authors">Bittner V, et al.</div>
                    <div class="reference-journal">Journal of the American Heart Association, 2013</div>
                    <div class="reference-doi">DOI: 10.1161/JAHA.113.000190</div>
                </div>
            </div>
        </div>
        
        <div class="tab-content" id="lp-a-content">
            <h2><i class="fas fa-vial"></i> 脂蛋白(a) [Lp(a)] 参考指南</h2>
            
            <div class="lp-a-info">
                <h3><i class="fas fa-info-circle"></i> 关于脂蛋白(a)</h3>
                <p>脂蛋白(a) [Lp(a)] 是一种独立的遗传性心血管疾病风险因素，不受生活方式改变影响。高水平Lp(a)与动脉粥样硬化、血栓形成和主动脉瓣狭窄风险增加相关。</p>
                
                <div class="lp-a-values">
                    <div class="lp-a-card">
                        <div class="lp-a-range">理想水平: &lt; 75 μmol/L</div>
                        <div class="lp-a-interpretation">心血管风险最低</div>
                    </div>
                    <div class="lp-a-card">
                        <div class="lp-a-range">临界高值: 75-125 μmol/L</div>
                        <div class="lp-a-interpretation">中度心血管风险</div>
                    </div>
                    <div class="lp-a-card">
                        <div class="lp-a-range">高风险: 125-250 μmol/L</div>
                        <div class="lp-a-interpretation">显著心血管风险</div>
                    </div>
                    <div class="lp-a-card">
                        <div class="lp-a-range">极高风险: &gt; 250 μmol/L</div>
                        <div class="lp-a-interpretation">心血管风险极高</div>
                    </div>
                </div>
            </div>
            
            <div class="research-section">
                <h3><i class="fas fa-lightbulb"></i> 临床意义与管理建议</h3>
                <div class="reference-item">
                    <p><i class="fas fa-dna"></i> <strong>遗传因素：</strong> Lp(a)水平主要由遗传决定，不受饮食、运动等生活方式改变影响。</p>
                </div>
                <div class="reference-item">
                    <p><i class="fas fa-user-md"></i> <strong>检测建议：</strong> 所有成年人应至少检测一次Lp(a)水平，尤其是有早发心血管疾病家族史者。</p>
                </div>
                <div class="reference-item">
                    <p><i class="fas fa-heartbeat"></i> <strong>风险评估：</strong> Lp(a) > 125 μmol/L视为心血管疾病独立风险因素，需强化其他风险因素管理。</p>
                </div>
                <div class="reference-item">
                    <p><i class="fas fa-pills"></i> <strong>治疗进展：</strong> 目前尚无特效药物降低Lp(a)，但新型RNA靶向治疗药物正在研发中。</p>
                </div>
                <div class="reference-item">
                    <p><i class="fas fa-clipboard-list"></i> <strong>管理策略：</strong> 严格控制LDL-C、血压、血糖，戒烟，保持健康体重。</p>
                </div>
            </div>
            
            <div class="research-section">
                <h3><i class="fas fa-sync-alt"></i> 单位转换</h3>
                <div class="reference-item">
                    <p><strong>mg/dL 转换为 μmol/L：</strong> 乘以 0.025</p>
                    <p><strong>例如：</strong> 30 mg/dL ≈ 0.75 μmol/L</p>
                    <p><strong>nmol/L 转换为 μmol/L：</strong> 除以 1000</p>
                    <p><strong>例如：</strong> 75 nmol/L = 0.075 μmol/L</p>
                </div>
            </div>
        </div>
        
        <div class="notification" id="notification">
            <i class="fas fa-check-circle"></i> 操作成功！
        </div>
        
        <footer>
            <p>© 2025 血脂指数计算器 | 基于最新医学研究 | 数据仅供参考，不能替代专业医疗建议</p>
        </footer>
    </div>

    <script>
        // 全局变量
        let historyData = JSON.parse(localStorage.getItem('lipidHistory')) || [];
        let currentResults = null;
        
        // 设置当前日期和时间
        function setDateTime() {
            const now = new Date();
            const year = now.getFullYear();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            
            document.getElementById('currentDate').value = `${year}-${month}-${day}`;
            document.getElementById('currentTime').value = `${hours}:${minutes}`;
        }
        
        // 显示通知
        function showNotification(message, isSuccess = true) {
            const notification = document.getElementById('notification');
            notification.innerHTML = `<i class="fas ${isSuccess ? 'fa-check-circle' : 'fa-exclamation-circle'}"></i> ${message}`;
            notification.style.background = isSuccess ? '#27ae60' : '#e74c3c';
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        // 标签切换功能
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                // 移除所有活动标签和内容
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                
                // 添加活动类到当前标签
                tab.classList.add('active');
                const tabContentId = tab.getAttribute('data-tab') + '-content';
                document.getElementById(tabContentId).classList.add('active');
            });
        });
        
        // 计算所有指数
        document.getElementById('calculateBtn').addEventListener('click', calculateAll);
        
        function calculateAll() {
            // 获取输入值
            const tc = parseFloat(document.getElementById('tc').value) || 0;
            const hdl = parseFloat(document.getElementById('hdl').value) || 0;
            const tg = parseFloat(document.getElementById('tg').value) || 0;
            const ldl = parseFloat(document.getElementById('ldl').value) || 0;
            const apoA1 = parseFloat(document.getElementById('apoA1').value) || null;
            const apoB = parseFloat(document.getElementById('apoB').value) || null;
            
            // 验证必需输入
            if (!tc || !hdl || !tg || !ldl) {
                showNotification('请填写所有必需的血脂参数！', false);
                return;
            }
            
            // 计算各种比值和指数
            const tcHdl = hdl ? (tc / hdl).toFixed(2) : 0;
            const tgHdl = hdl ? (tg / hdl).toFixed(2) : 0;
            const ldlHdl = hdl ? (ldl / hdl).toFixed(2) : 0;
            const ai = hdl ? ((tc - hdl) / hdl).toFixed(2) : 0;
            const nonHdlHdl = hdl ? ((tc - hdl) / hdl).toFixed(2) : 0;
            const rc = (tc - hdl -ldl).toFixed(2);
            
            // 创建结果数组
            currentResults = [
                { 
                    title: "TC/HDL-C 比值", 
                    value: tcHdl,
                    description: "心血管风险指标",
                    status: tcHdl < 4 ? "理想" : (tcHdl < 5 ? "临界高" : "高风险"),
                    statusClass: tcHdl < 4 ? "status-normal" : (tcHdl < 5 ? "status-warning" : "status-danger")
                },
                { 
                    title: "TG/HDL-C 比值", 
                    value: tgHdl,
                    description: "胰岛素抵抗标志",
                    status: tgHdl < 1 ? "理想" : (tgHdl < 2 ? "临界高" : "高风险"),
                    statusClass: tgHdl < 1 ? "status-normal" : (tgHdl < 2 ? "status-warning" : "status-danger")
                },
                { 
                    title: "LDL-C/HDL-C 比值", 
                    value: ldlHdl,
                    description: "胆固醇平衡指标",
                    status: ldlHdl < 2.5 ? "理想" : (ldlHdl < 3.5 ? "临界高" : "高风险"),
                    statusClass: ldlHdl < 2.5 ? "status-normal" : (ldlHdl < 3.5 ? "status-warning" : "status-danger")
                },
                { 
                    title: "动脉硬化指数 (AI)", 
                    value: ai,
                    description: "(TC - HDL-C)/HDL-C",
                    status: ai < 3 ? "理想" : (ai < 4 ? "临界高" : "高风险"),
                    statusClass: ai < 3 ? "status-normal" : (ai < 4 ? "status-warning" : "status-danger")
                },
                { 
                    title: "残余胆固醇 (RC)", 
                    value: rc,
                    description: "TC - HDL-C - LDL-C",
                    status: rc < 1.0? "理想" : (rc < 0.8 ? "临界高" : "高风险"),
                    statusClass: rc < 1.0 ? "status-normal" : (rc < 0.8 ? "status-warning" : "status-danger")
                }
            ];
            
            // 添加ApoA1/ApoB比值（如果数据可用）
            if (apoA1 !== null && apoB !== null && apoB !== 0) {
                const apoRatio = (apoA1 / apoB).toFixed(2);
                currentResults.push({ 
                    title: "ApoA1/ApoB 比值", 
                    value: apoRatio,
                    description: "心血管风险精准指标",
                    status: apoRatio > 1.2 ? "理想" : (apoRatio > 0.9 ? "临界低" : "高风险"),
                    statusClass: apoRatio > 1.2 ? "status-normal" : (apoRatio > 0.9 ? "status-warning" : "status-danger")
                });
            } else {
                // 添加提示信息
                currentResults.push({ 
                    title: "ApoA1/ApoB 比值", 
                    value: "-",
                    description: "需要输入ApoA1和ApoB数据",
                    status: "未计算",
                    statusClass: "status-info",
                    disabled: true
                });
            }
            
            // 显示结果
            displayResults(currentResults);
            showNotification('计算完成！');
        }
        
        // 显示计算结果
        function displayResults(results) {
            const resultsGrid = document.getElementById('resultsGrid');
            
            if (results.length === 0) {
                resultsGrid.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-calculator"></i>
                        <h3>等待计算结果</h3>
                        <p>输入您的血脂参数后点击"计算"按钮</p>
                    </div>
                `;
                return;
            }
            
            resultsGrid.innerHTML = '';
            
            results.forEach(result => {
                let cardClass = '';
                if (result.disabled) {
                    cardClass = 'disabled';
                } else {
                    cardClass = result.statusClass.includes('danger') ? 'high' : 
                              result.statusClass.includes('warning') ? 'medium' : 'low';
                }
                
                const resultCard = document.createElement('div');
                resultCard.className = `result-card ${cardClass}`;
                resultCard.innerHTML = `
                    <div class="result-title"><i class="fas fa-calculator"></i> ${result.title}</div>
                    <div class="result-value">${result.value}</div>
                    <div class="result-description">
                        <p>${result.description}</p>
                        <p>状态: <span class="result-status ${result.statusClass}">${result.status}</span></p>
                    </div>
                `;
                
                resultsGrid.appendChild(resultCard);
            });
        }
        
        // 重置表单
        document.getElementById('resetBtn').addEventListener('click', () => {
            document.getElementById('tc').value = '';
            document.getElementById('hdl').value = '';
            document.getElementById('tg').value = '';
            document.getElementById('ldl').value = '';
            document.getElementById('apoA1').value = '';
            document.getElementById('apoB').value = '';
            currentResults = null;
            displayResults([]);
            showNotification('表单已重置');
        });
        
        // 保存当前计算结果（计算器标签页）
        document.getElementById('saveResultBtn').addEventListener('click', saveCurrentData);
        
        // 保存当前数据（数据管理标签页）
        document.getElementById('saveDataBtn').addEventListener('click', saveCurrentData);
        
        // 通用的保存函数
        function saveCurrentData() {
            if (!currentResults) {
                showNotification('请先进行计算！', false);
                return;
            }
            
            let recordName = '';
            const activeTab = document.querySelector('.tab.active').getAttribute('data-tab');
            
            if (activeTab === 'calculator') {
                recordName = prompt('请输入记录名称：', `记录 ${new Date().toLocaleDateString()}`);
            } else if (activeTab === 'data') {
                recordName = document.getElementById('recordNameData').value.trim();
                if (!recordName) {
                    recordName = prompt('请输入记录名称：', `记录 ${new Date().toLocaleDateString()}`);
                }
            }
            
            if (!recordName) {
                showNotification('保存已取消', false);
                return;
            }
            
            const dateTime = document.getElementById('currentDate').value + ' ' + document.getElementById('currentTime').value;
            
            const record = {
                name: recordName,
                date: dateTime,
                values: {
                    tc: document.getElementById('tc').value,
                    hdl: document.getElementById('hdl').value,
                    tg: document.getElementById('tg').value,
                    ldl: document.getElementById('ldl').value,
                    apoA1: document.getElementById('apoA1').value || '未提供',
                    apoB: document.getElementById('apoB').value || '未提供'
                },
                results: currentResults
            };
            
            historyData.push(record);
            localStorage.setItem('lipidHistory', JSON.stringify(historyData));
            updateHistoryList();
            
            // 清除数据管理标签页中的记录名称
            document.getElementById('recordNameData').value = '';
            
            showNotification(`记录 "${recordName}" 已保存！`);
        }
        
        // 更新历史记录列表
        function updateHistoryList() {
            const historyList = document.getElementById('historyList');
            
            if (historyData.length === 0) {
                historyList.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-database"></i>
                        <h3>暂无历史记录</h3>
                        <p>保存计算结果后将会显示在这里</p>
                    </div>
                `;
                return;
            }
            
            historyList.innerHTML = '';
            
            historyData.forEach((item, index) => {
                const dataItem = document.createElement('div');
                dataItem.className = 'data-item';
                dataItem.innerHTML = `
                    <div>
                        <div><strong>${item.name}</strong></div>
                        <div style="font-size: 0.8rem; color: #666;">${item.date}</div>
                    </div>
                    <div class="actions">
                        <button class="btn-small btn-edit" data-index="${index}"><i class="fas fa-edit"></i></button>
                        <button class="btn-small btn-delete" data-index="${index}"><i class="fas fa-trash"></i></button>
                    </div>
                `;
                historyList.appendChild(dataItem);
            });
            
            // 添加删除事件
            document.querySelectorAll('.btn-delete').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const index = e.target.closest('.btn-delete').getAttribute('data-index');
                    const recordName = historyData[index].name;
                    historyData.splice(index, 1);
                    localStorage.setItem('lipidHistory', JSON.stringify(historyData));
                    updateHistoryList();
                    showNotification(`记录 "${recordName}" 已删除`);
                });
            });
            
            // 添加编辑事件
            document.querySelectorAll('.btn-edit').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const index = e.target.closest('.btn-edit').getAttribute('data-index');
                    const record = historyData[index];
                    
                    // 填充表单
                    document.getElementById('tc').value = record.values.tc;
                    document.getElementById('hdl').value = record.values.hdl;
                    document.getElementById('tg').value = record.values.tg;
                    document.getElementById('ldl').value = record.values.ldl;
                    
                    // 处理可选字段
                    if (record.values.apoA1 !== '未提供') {
                        document.getElementById('apoA1').value = record.values.apoA1;
                    }
                    if (record.values.apoB !== '未提供') {
                        document.getElementById('apoB').value = record.values.apoB;
                    }
                    
                    // 显示结果
                    currentResults = record.results;
                    displayResults(currentResults);
                    
                    // 切换到计算器标签页
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    document.querySelector('[data-tab="calculator"]').classList.add('active');
                    document.getElementById('calculator-content').classList.add('active');
                    
                    showNotification(`记录 "${record.name}" 已加载`);
                });
            });
        }
        
        // 导出数据
        document.getElementById('exportBtn').addEventListener('click', () => {
            if (historyData.length === 0) {
                showNotification('没有数据可导出', false);
                return;
            }
            
            const dataStr = JSON.stringify(historyData, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = `lipid_data_${new Date().toISOString().slice(0,10)}.json`;
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
            
            showNotification('数据已导出');
        });
        
        // 导入数据
        document.getElementById('importBtn').addEventListener('click', () => {
            document.getElementById('importFile').click();
        });
        
        document.getElementById('importFile').addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = (event) => {
                try {
                    const importedData = JSON.parse(event.target.result);
                    historyData = importedData;
                    localStorage.setItem('lipidHistory', JSON.stringify(historyData));
                    updateHistoryList();
                    showNotification('数据导入成功！');
                } catch (error) {
                    showNotification('导入失败：文件格式不正确', false);
                }
                
                // 重置文件输入
                e.target.value = '';
            };
            reader.readAsText(file);
        });
        
        // 初始化
        setDateTime();
        updateHistoryList();
        
        // 每10秒更新时间
        setInterval(setDateTime, 10000);
    </script>
</body>
</html>
